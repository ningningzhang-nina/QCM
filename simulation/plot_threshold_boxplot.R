library(R.matlab)
library(ggplot2)
library(latex2exp)
setwd("/Users/gina/Downloads/Research/2.QCM/Code files/final_simulation/results/")
dgp1<-readMat("new_DGP1_garch.mat")
dgp2<-readMat("new_DGP2_studentt.mat")
dgp3<-readMat("new_DGP3_garch_snp.mat")
dgp4<-readMat("new_dpg4_gir_skew_studentt.mat")
dgp5<-readMat("DGP5_arma_mx_garch.mat")
setEPS()
postscript("dgp1_threshold.eps",width=8,height=3)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
nums=c(100,200,300,400,500,600,700,800,900,1000)
par(mar=c(0.1,2.7,1.2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=0.8,cex.lab=1.2)
par(mfrow=c(3,4))
boxplot(dgp1$e91[,nums],ylab=TeX(r'($\Delta_{h,t}$)'),ylim=c(-0.14,0.145),main=TeX(r'($p^{*}=0$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.14,0,0.145))
boxplot(dgp1$e101[,nums],ylim=c(-0.14,0.145),main=TeX(r'($p^{*}=0.1$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp1$e111[,nums],ylim=c(-0.14,0.145),main=TeX(r'($p^{*}=0.3$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp1$e121[,nums],ylim=c(-0.14,0.145),main=TeX(r'($p^{*}=0.5$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp1$e92[,nums],ylab=TeX(r'($\Delta_{s,t}$)'),ylim=c(-0.562,0.501), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.562,0,0.501))
boxplot(dgp1$e102[,nums],ylim=c(-0.562,0.501), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp1$e112[,nums],ylim=c(-0.562,0.501), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp1$e122[,nums],ylim=c(-0.562,0.501), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp1$e93[,nums],ylab=TeX(r'($\Delta_{k,t}$)'),ylim=c(-1.38,1.69), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at =c(-1.38,0,1.69))
boxplot(dgp1$e103[,nums],ylim=c(-1.38,1.69), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp1$e113[,nums],ylim=c(-1.38,1.69), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp1$e123[,nums],ylim=c(-1.38,1.69), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
dev.off()

c(min(dgp1$e91[,nums]),min(dgp1$e101[,nums]),min(dgp1$e111[,nums]),min(dgp1$e121[,nums]))
c(max(dgp1$e91[,nums]),max(dgp1$e101[,nums]),max(dgp1$e111[,nums]),max(dgp1$e121[,nums]))
c(min(dgp1$e92[,nums]),min(dgp1$e102[,nums]),min(dgp1$e112[,nums]),min(dgp1$e122[,nums]))
c(max(dgp1$e92[,nums]),max(dgp1$e102[,nums]),max(dgp1$e112[,nums]),max(dgp1$e122[,nums]))
c(min(dgp1$e93[,nums]),min(dgp1$e103[,nums]),min(dgp1$e113[,nums]),min(dgp1$e123[,nums]))
c(max(dgp1$e93[,nums]),max(dgp1$e103[,nums]),max(dgp1$e113[,nums]),max(dgp1$e123[,nums]))

setEPS()
postscript("dgp2_threshold.eps",width=8,height=3)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.1,2.7,1.2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=0.8,cex.lab=1.2)
par(mfrow=c(3,4))
boxplot(dgp2$e91[,nums],ylab=TeX(r'($\Delta_{h,t}$)'),ylim=c(-0.162,0.199),main=TeX(r'($p^{*}=0$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.162,0,0.199))
boxplot(dgp2$e101[,nums],ylim=c(-0.162,0.199),main=TeX(r'($p^{*}=0.1$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp2$e111[,nums],ylim=c(-0.162,0.199),main=TeX(r'($p^{*}=0.3$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp2$e121[,nums],ylim=c(-0.162,0.199),main=TeX(r'($p^{*}=0.5$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp2$e92[,nums],ylab=TeX(r'($\Delta_{s,t}$)'),ylim=c(-0.696,0.723), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.696,0,0.723))
boxplot(dgp2$e102[,nums],ylim=c(-0.696,0.723), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp2$e112[,nums],ylim=c(-0.696,0.723), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp2$e122[,nums],ylim=c(-0.696,0.723), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp2$e93[,nums],ylab=TeX(r'($\Delta_{k,t}$)'),ylim=c(-6.35,2.02), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at =c(-6.35,0,2.02))
boxplot(dgp2$e103[,nums],ylim=c(-6.35,2.02), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp2$e113[,nums],ylim=c(-6.35,2.02), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp2$e123[,nums],ylim=c(-6.35,2.02), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
dev.off()

c(min(dgp2$e91[,nums]),min(dgp2$e101[,nums]),min(dgp2$e111[,nums]),min(dgp2$e121[,nums]))
c(max(dgp2$e91[,nums]),max(dgp2$e101[,nums]),max(dgp2$e111[,nums]),max(dgp2$e121[,nums]))
c(min(dgp2$e92[,nums]),min(dgp2$e102[,nums]),min(dgp2$e112[,nums]),min(dgp2$e122[,nums]))
c(max(dgp2$e92[,nums]),max(dgp2$e102[,nums]),max(dgp2$e112[,nums]),max(dgp2$e122[,nums]))
c(min(dgp2$e93[,nums]),min(dgp2$e103[,nums]),min(dgp2$e113[,nums]),min(dgp2$e123[,nums]))
c(max(dgp2$e93[,nums]),max(dgp2$e103[,nums]),max(dgp2$e113[,nums]),max(dgp2$e123[,nums]))

setEPS()
postscript("dgp3_threshold.eps",width=8,height=3)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.1,2.7,1.2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=0.8,cex.lab=1.2)
par(mfrow=c(3,4))
boxplot(dgp3$e91[,nums],ylab=TeX(r'($\Delta_{h,t}$)'),ylim=c(-0.138,0.143),main=TeX(r'($p^{*}=0$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.138,0,0.143))
boxplot(dgp3$e101[,nums],ylim=c(-0.138,0.143),main=TeX(r'($p^{*}=0.1$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp3$e111[,nums],ylim=c(-0.138,0.143),main=TeX(r'($p^{*}=0.3$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp3$e121[,nums],ylim=c(-0.138,0.143),main=TeX(r'($p^{*}=0.5$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp3$e92[,nums],ylab=TeX(r'($\Delta_{s,t}$)'),ylim=c(-0.913,0.906), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.913,0,0.906))
boxplot(dgp3$e102[,nums],ylim=c(-0.913,0.906), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp3$e112[,nums],ylim=c(-0.913,0.906), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp3$e122[,nums],ylim=c(-0.913,0.906), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp3$e93[,nums],ylab=TeX(r'($\Delta_{k,t}$)'),ylim=c(-2.487,2.20), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at =c(-2.487,0,2.20))
boxplot(dgp3$e103[,nums],ylim=c(-2.487,2.20), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp3$e113[,nums],ylim=c(-2.487,2.20), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp3$e123[,nums],ylim=c(-2.487,2.20), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
dev.off()

c(min(dgp3$e91[,nums]),min(dgp3$e101[,nums]),min(dgp3$e111[,nums]),min(dgp3$e121[,nums]))
c(max(dgp3$e91[,nums]),max(dgp3$e101[,nums]),max(dgp3$e111[,nums]),max(dgp3$e121[,nums]))
c(min(dgp3$e92[,nums]),min(dgp3$e102[,nums]),min(dgp3$e112[,nums]),min(dgp3$e122[,nums]))
c(max(dgp3$e92[,nums]),max(dgp3$e102[,nums]),max(dgp3$e112[,nums]),max(dgp3$e122[,nums]))
c(min(dgp3$e93[,nums]),min(dgp3$e103[,nums]),min(dgp3$e113[,nums]),min(dgp3$e123[,nums]))
c(max(dgp3$e93[,nums]),max(dgp3$e103[,nums]),max(dgp3$e113[,nums]),max(dgp3$e123[,nums]))

setEPS()
postscript("dgp4_threshold.eps",width=8,height=3)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.1,2.7,1.2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=0.8,cex.lab=1.2)
par(mfrow=c(3,4))
boxplot(dgp4$e91[,nums],ylab=TeX(r'($\Delta_{h,t}$)'),ylim=c(-0.117,0.067),main=TeX(r'($p^{*}=0$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.117,0,0.067))
boxplot(dgp4$e101[,nums],ylim=c(-0.117,0.067),main=TeX(r'($p^{*}=0.1$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp4$e111[,nums],ylim=c(-0.117,0.067),main=TeX(r'($p^{*}=0.3$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp4$e121[,nums],ylim=c(-0.117,0.067),main=TeX(r'($p^{*}=0.5$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp4$e92[,nums],ylab=TeX(r'($\Delta_{s,t}$)'),ylim=c(-0.536,0.913), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.536,0,0.913))
boxplot(dgp4$e102[,nums],ylim=c(-0.536,0.913), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp4$e112[,nums],ylim=c(-0.536,0.913), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp4$e122[,nums],ylim=c(-0.536,0.913), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp4$e93[,nums],ylab=TeX(r'($\Delta_{k,t}$)'),ylim=c(-1.241,2.21), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at =c(-1.241,0,2.21))
boxplot(dgp4$e103[,nums],ylim=c(-1.241,2.21), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp4$e113[,nums],ylim=c(-1.241,2.21), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp4$e123[,nums],ylim=c(-1.241,2.21), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
dev.off()

c(min(dgp4$e91[,nums]),min(dgp4$e101[,nums]),min(dgp4$e111[,nums]),min(dgp4$e121[,nums]))
c(max(dgp4$e91[,nums]),max(dgp4$e101[,nums]),max(dgp4$e111[,nums]),max(dgp4$e121[,nums]))
c(min(dgp4$e92[,nums]),min(dgp4$e102[,nums]),min(dgp4$e112[,nums]),min(dgp4$e122[,nums]))
c(max(dgp4$e92[,nums]),max(dgp4$e102[,nums]),max(dgp4$e112[,nums]),max(dgp4$e122[,nums]))
c(min(dgp4$e93[,nums]),min(dgp4$e103[,nums]),min(dgp4$e113[,nums]),min(dgp4$e123[,nums]))
c(max(dgp4$e93[,nums]),max(dgp4$e103[,nums]),max(dgp4$e113[,nums]),max(dgp4$e123[,nums]))

setEPS()
postscript("dgp5_threshold.eps",width=8,height=3)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.1,2.7,1.2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=0.8,cex.lab=1.2)
par(mfrow=c(3,4))
boxplot(dgp5$e91[,nums],ylab=TeX(r'($\Delta_{h,t}$)'),ylim=c(-5.34,1.03),main=TeX(r'($p^{*}=0$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-5.34,0,1.03))
boxplot(dgp5$e101[,nums],ylim=c(-5.34,1.03),main=TeX(r'($p^{*}=0.1$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp5$e111[,nums],ylim=c(-5.34,1.03),main=TeX(r'($p^{*}=0.3$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp5$e121[,nums],ylim=c(-5.34,1.03),main=TeX(r'($p^{*}=0.5$)'), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0))
boxplot(dgp5$e92[,nums],ylab=TeX(r'($\Delta_{s,t}$)'),ylim=c(-1.08,1.92), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-1.08,0,1.92))
boxplot(dgp5$e102[,nums],ylim=c(-1.08,1.92), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp5$e112[,nums],ylim=c(-1.08,1.92), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp5$e122[,nums],ylim=c(-1.08,1.92), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp5$e93[,nums],ylab=TeX(r'($\Delta_{k,t}$)'),ylim=c(-2.14,2.85), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at =c(-2.14,0,2.85))
boxplot(dgp5$e103[,nums],ylim=c(-2.14,2.85), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp5$e113[,nums],ylim=c(-2.14,2.85), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
boxplot(dgp5$e123[,nums],ylim=c(-2.14,2.85), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0))
dev.off()

c(min(dgp5$e91[,nums]),min(dgp5$e101[,nums]),min(dgp5$e111[,nums]),min(dgp5$e121[,nums]))
c(max(dgp5$e91[,nums]),max(dgp5$e101[,nums]),max(dgp5$e111[,nums]),max(dgp5$e121[,nums]))
c(min(dgp5$e92[,nums]),min(dgp5$e102[,nums]),min(dgp5$e112[,nums]),min(dgp5$e122[,nums]))
c(max(dgp5$e92[,nums]),max(dgp5$e102[,nums]),max(dgp5$e112[,nums]),max(dgp5$e122[,nums]))
c(min(dgp5$e93[,nums]),min(dgp5$e103[,nums]),min(dgp5$e113[,nums]),min(dgp5$e123[,nums]))
c(max(dgp5$e93[,nums]),max(dgp5$e103[,nums]),max(dgp5$e113[,nums]),max(dgp5$e123[,nums]))
