library(matrixStats)
library(R.matlab)
library(ggplot2)
library(latex2exp)
library(R.matlab)
library(ggplot2)
library(latex2exp)
setwd("/Users/gina/Downloads/Research/2.QCM/Code files/final_simulation/results/")
dgp1<-readMat("new_DGP1_garch.mat")
dgp2<-readMat("new_DGP2_studentt.mat")
dgp3<-readMat("new_DGP3_garch_snp.mat")
dgp4<-readMat("new_dpg4_gir_skew_studentt.mat")
dgp5<-readMat("DGP5_arma_mx_garch.mat")
setEPS()
postscript("simulation_different_threshold_sd.eps",width=10,height=5)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.5,2.7,2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=1,cex.lab=1.2)
#layout(matrix(c(1,2,3,4,5,6,7,7,nrow=4,ncol=5, byrow=TRUE))
#par(mfrow=c(4,3))
m <- matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,16,16,16,16),nrow = 4,ncol = 5,byrow = TRUE)
layout(mat = m,heights = c(0.4,0.4,0.4,0.17))
nums=c(100,200,300,400,500,600,700,800,900,1000)
plot(colSds(dgp1$e91[,nums]),type="b",ylab=TeX(r'(SD(${\Delta}_{h,t}$))'),main="DGP1",ylim=c(0.0153,0.027), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.0153,0.027))
lines(colSds(dgp1$e101[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp1$e111[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp1$e121[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp2$e91[,nums]),type="b",ylab="",main="DGP2",ylim=c(0.0197,0.030), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.0197,0.030))
lines(colSds(dgp2$e101[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp2$e111[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp2$e121[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp3$e91[,nums]),type="b",ylab="",main="DGP3",ylim=c(0.0158,0.0261), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.0158,0.0261))
lines(colSds(dgp3$e101[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp3$e111[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp3$e121[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp4$e91[,nums]),type="b",ylab="",main="DGP4",ylim=c(0.010,0.0183), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.010,0.0183))
lines(colSds(dgp4$e101[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp4$e111[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp4$e121[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp5$e91[,nums]),type="b",ylab="",main="DGP5",ylim=c(0.424,0.781), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.424,0.781))
lines(colSds(dgp5$e101[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp5$e111[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp5$e121[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp1$e92[,nums]),type="b",ylab=TeX(r'(SD(${\Delta}_{s,t}$))'),ylim=c(0.131,0.173), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.131,0.173))
lines(colSds(dgp1$e102[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp1$e112[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp1$e122[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp2$e92[,nums]),type="b",ylab="",ylim=c(0.145,0.197), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.145,0.197))
lines(colSds(dgp2$e102[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp2$e112[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp2$e122[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp3$e92[,nums]),type="b",ylab="",ylim=c(0.202,0.252), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.202,0.252))
lines(colSds(dgp3$e102[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp3$e112[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp3$e122[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp4$e92[,nums]),type="b",ylab="",ylim=c(0.117,0.176), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.117,0.176))
lines(colSds(dgp4$e102[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp4$e112[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp4$e122[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp5$e92[,nums]),type="b",ylab="",ylim=c(0.169,0.259), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(0.169,0.259))
lines(colSds(dgp5$e102[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp5$e112[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp5$e122[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp1$e93[,nums]),type="b",ylab=TeX(r'(SD(${\Delta}_{k,t}$))'),ylim=c(0.29,0.433), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.29,0.433))
lines(colSds(dgp1$e103[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp1$e113[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp1$e123[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp2$e93[,nums]),type="b",ylab="",ylim=c(0.91,1.213), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.91,1.213))
lines(colSds(dgp2$e103[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp2$e113[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp2$e123[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp3$e93[,nums]),type="b",ylab="",ylim=c(0.468,0.632), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.468,0.632))
lines(colSds(dgp3$e103[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp3$e113[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp3$e123[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp4$e93[,nums]),type="b",ylab="",ylim=c(0.301,0.454), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.301,0.454))
lines(colSds(dgp4$e103[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp4$e113[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp4$e123[,nums]),type="b",lty=4,pch=3)
plot(colSds(dgp5$e93[,nums]),type="b",ylab="",ylim=c(0.331,0.636), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.331,0.636))
lines(colSds(dgp5$e103[,nums]),type="b",lty=2,pch=0)
lines(colSds(dgp5$e113[,nums]),type="b",lty=3,pch=2)
lines(colSds(dgp5$e123[,nums]),type="b",lty=4,pch=3)
plot(1, type = "n", axes=FALSE, xlab="", ylab="")
legend(x="top", inset=0,
       legend=c(TeX(r'($p^*=0$)'),TeX(r'($p^*=0.1$)'),TeX(r'($p^*=0.3$)'),TeX(r'($p^*=0.5$)')),
       lty=c(1,2,3,4),pch=c(1,0,2,3),horiz=TRUE)
dev.off()

c(min(colSds(dgp1$e91[,nums])),min(colSds(dgp1$e101[,nums])),min(colSds(dgp1$e111[,nums])),min(colSds(dgp1$e121[,nums])))
c(max(colSds(dgp1$e91[,nums])),max(colSds(dgp1$e101[,nums])),max(colSds(dgp1$e111[,nums])),max(colSds(dgp1$e121[,nums])))
c(min(colSds(dgp2$e91[,nums])),min(colSds(dgp2$e101[,nums])),min(colSds(dgp2$e111[,nums])),min(colSds(dgp2$e121[,nums])))
c(max(colSds(dgp2$e91[,nums])),max(colSds(dgp2$e101[,nums])),max(colSds(dgp2$e111[,nums])),max(colSds(dgp2$e121[,nums])))
c(min(colSds(dgp3$e91[,nums])),min(colSds(dgp3$e101[,nums])),min(colSds(dgp3$e111[,nums])),min(colSds(dgp3$e121[,nums])))
c(max(colSds(dgp3$e91[,nums])),max(colSds(dgp3$e101[,nums])),max(colSds(dgp3$e111[,nums])),max(colSds(dgp3$e121[,nums])))
c(min(colSds(dgp4$e91[,nums])),min(colSds(dgp4$e101[,nums])),min(colSds(dgp4$e111[,nums])),min(colSds(dgp4$e121[,nums])))
c(max(colSds(dgp4$e91[,nums])),max(colSds(dgp4$e101[,nums])),max(colSds(dgp4$e111[,nums])),max(colSds(dgp4$e121[,nums])))
c(min(colSds(dgp5$e91[,nums])),min(colSds(dgp5$e101[,nums])),min(colSds(dgp5$e111[,nums])),min(colSds(dgp5$e121[,nums])))
c(max(colSds(dgp5$e91[,nums])),max(colSds(dgp5$e101[,nums])),max(colSds(dgp5$e111[,nums])),max(colSds(dgp5$e121[,nums])))


c(min(colSds(dgp1$e92[,nums])),min(colSds(dgp1$e102[,nums])),min(colSds(dgp1$e112[,nums])),min(colSds(dgp1$e122[,nums])))
c(max(colSds(dgp1$e92[,nums])),max(colSds(dgp1$e102[,nums])),max(colSds(dgp1$e112[,nums])),max(colSds(dgp1$e122[,nums])))
c(min(colSds(dgp2$e92[,nums])),min(colSds(dgp2$e102[,nums])),min(colSds(dgp2$e112[,nums])),min(colSds(dgp2$e122[,nums])))
c(max(colSds(dgp2$e92[,nums])),max(colSds(dgp2$e102[,nums])),max(colSds(dgp2$e112[,nums])),max(colSds(dgp2$e122[,nums])))
c(min(colSds(dgp3$e92[,nums])),min(colSds(dgp3$e102[,nums])),min(colSds(dgp3$e112[,nums])),min(colSds(dgp3$e122[,nums])))
c(max(colSds(dgp3$e92[,nums])),max(colSds(dgp3$e102[,nums])),max(colSds(dgp3$e112[,nums])),max(colSds(dgp3$e122[,nums])))
c(min(colSds(dgp4$e92[,nums])),min(colSds(dgp4$e102[,nums])),min(colSds(dgp4$e112[,nums])),min(colSds(dgp4$e122[,nums])))
c(max(colSds(dgp4$e92[,nums])),max(colSds(dgp4$e102[,nums])),max(colSds(dgp4$e112[,nums])),max(colSds(dgp4$e122[,nums])))
c(min(colSds(dgp5$e92[,nums])),min(colSds(dgp5$e102[,nums])),min(colSds(dgp5$e112[,nums])),min(colSds(dgp5$e122[,nums])))
c(max(colSds(dgp5$e92[,nums])),max(colSds(dgp5$e102[,nums])),max(colSds(dgp5$e112[,nums])),max(colSds(dgp5$e122[,nums])))

c(min(colSds(dgp1$e93[,nums])),min(colSds(dgp1$e103[,nums])),min(colSds(dgp1$e113[,nums])),min(colSds(dgp1$e123[,nums])))
c(max(colSds(dgp1$e93[,nums])),max(colSds(dgp1$e103[,nums])),max(colSds(dgp1$e113[,nums])),max(colSds(dgp1$e123[,nums])))
c(min(colSds(dgp2$e93[,nums])),min(colSds(dgp2$e103[,nums])),min(colSds(dgp2$e113[,nums])),min(colSds(dgp2$e123[,nums])))
c(max(colSds(dgp2$e93[,nums])),max(colSds(dgp2$e103[,nums])),max(colSds(dgp2$e113[,nums])),max(colSds(dgp2$e123[,nums])))
c(min(colSds(dgp3$e93[,nums])),min(colSds(dgp3$e103[,nums])),min(colSds(dgp3$e113[,nums])),min(colSds(dgp3$e123[,nums])))
c(max(colSds(dgp3$e93[,nums])),max(colSds(dgp3$e103[,nums])),max(colSds(dgp3$e113[,nums])),max(colSds(dgp3$e123[,nums])))
c(min(colSds(dgp4$e93[,nums])),min(colSds(dgp4$e103[,nums])),min(colSds(dgp4$e113[,nums])),min(colSds(dgp4$e123[,nums])))
c(max(colSds(dgp4$e93[,nums])),max(colSds(dgp4$e103[,nums])),max(colSds(dgp4$e113[,nums])),max(colSds(dgp4$e123[,nums])))
c(min(colSds(dgp5$e93[,nums])),min(colSds(dgp5$e103[,nums])),min(colSds(dgp5$e113[,nums])),min(colSds(dgp5$e123[,nums])))
c(max(colSds(dgp5$e93[,nums])),max(colSds(dgp5$e103[,nums])),max(colSds(dgp5$e113[,nums])),max(colSds(dgp5$e123[,nums])))

