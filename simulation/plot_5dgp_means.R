library(matrixStats)
library(R.matlab)
library(ggplot2)
library(latex2exp)
library(R.matlab)
library(ggplot2)
library(latex2exp)
setwd("/Users/gina/Downloads/Research/2.QCM/Code files/final_simulation/results/")
dgp1<-readMat("new_DGP1_garch.mat")
dgp2<-readMat("new_DGP2_studentt.mat")
dgp3<-readMat("new_DGP3_garch_snp.mat")
dgp4<-readMat("new_dpg4_gir_skew_studentt.mat")
dgp5<-readMat("DGP5_arma_mx_garch.mat")
setEPS()
postscript("simulation_different_threshold_means.eps",width=10,height=5)
#pdf("simulation.pdf",width=12,height=5)
#par(mar=c(2,4.3,4,0.2),cex.main=1, font.main = 1,cex.axis=1,cex.lab=1)
par(mar=c(0.5,2.7,2,0.1),mgp = c(1.2, 0.4, 0),cex.main=1, font.main = 1.2,cex.axis=1,cex.lab=1.2)
#layout(matrix(c(1,2,3,4,5,6,7,7,nrow=4,ncol=5, byrow=TRUE))
#par(mfrow=c(4,3))
m <- matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,16,16,16,16),nrow = 4,ncol = 5,byrow = TRUE)
layout(mat = m,heights = c(0.4,0.4,0.4,0.17))
nums=c(100,200,300,400,500,600,700,800,900,1000)
plot(colMeans(dgp1$e91[,nums]),type="b",ylab=TeX(r'($\bar{\Delta}_{h,t}$)'),main="DGP1",ylim=c(-0.0031,0.0040), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.0031,0,0.0040))
lines(colMeans(dgp1$e101[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp1$e111[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp1$e121[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp2$e91[,nums]),type="b",ylab="",main="DGP2",ylim=c(-0.002,0.0045), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.002,0,0.0045))
lines(colMeans(dgp2$e101[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp2$e111[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp2$e121[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp3$e91[,nums]),type="b",ylab="",main="DGP3",ylim=c(-0.0013,0.007), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.0013,0,0.007))
lines(colMeans(dgp3$e101[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp3$e111[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp3$e121[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp4$e91[,nums]),type="b",ylab="",main="DGP4",ylim=c(-0.0020,0.00452), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.0020,0.00452))
lines(colMeans(dgp4$e101[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp4$e111[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp4$e121[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp5$e91[,nums]),type="b",ylab="",main="DGP5",ylim=c(-0.276,0.032), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.276,0.032))
lines(colMeans(dgp5$e101[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp5$e111[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp5$e121[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp1$e92[,nums]),type="b",ylab=TeX(r'($\bar{\Delta}_{s,t}$)'),ylim=c(-0.0276,0.021), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.0276,0,0.021))
lines(colMeans(dgp1$e102[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp1$e112[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp1$e122[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp2$e92[,nums]),type="b",ylab="",ylim=c(-0.056,-0.014), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.056,-0.014))
lines(colMeans(dgp2$e102[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp2$e112[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp2$e122[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp3$e92[,nums]),type="b",ylab="",ylim=c(-0.12,-0.005), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.12,-0.005))
lines(colMeans(dgp3$e102[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp3$e112[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp3$e122[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp4$e92[,nums]),type="b",ylab="",ylim=c(-0.037,0.0311), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.037,0.0311))
lines(colMeans(dgp4$e102[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp4$e112[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp4$e122[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp5$e92[,nums]),type="b",ylab="",ylim=c(-0.134,0.069), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at=c(-0.134,0.069))
lines(colMeans(dgp5$e102[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp5$e112[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp5$e122[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp1$e93[,nums]),type="b",ylab=TeX(r'($\bar{\Delta}_{k,t}$)'),ylim=c(0.024,0.116), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(0.024,0.116))
lines(colMeans(dgp1$e103[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp1$e113[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp1$e123[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp2$e93[,nums]),type="b",ylab="",ylim=c(-0.461,-0.18), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.461,-0.18))
lines(colMeans(dgp2$e103[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp2$e113[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp2$e123[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp3$e93[,nums]),type="b",ylab="",ylim=c(-0.084,0.125), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.084,0,0.125))
lines(colMeans(dgp3$e103[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp3$e113[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp3$e123[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp4$e93[,nums]),type="b",ylab="",ylim=c(-0.068,0.024), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.068,0.024))
lines(colMeans(dgp4$e103[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp4$e113[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp4$e123[,nums]),type="b",lty=4,pch=3)
plot(colMeans(dgp5$e93[,nums]),type="b",ylab="",ylim=c(-0.131,0.25), xaxt = "n",yaxt="n",lwd=0.5)
axis(side = 2, at = c(-0.131,0.25))
lines(colMeans(dgp5$e103[,nums]),type="b",lty=2,pch=0)
lines(colMeans(dgp5$e113[,nums]),type="b",lty=3,pch=2)
lines(colMeans(dgp5$e123[,nums]),type="b",lty=4,pch=3)
plot(1, type = "n", axes=FALSE, xlab="", ylab="")
legend( x="top", inset=0,
        legend=c(TeX(r'($p^*=0$)'),TeX(r'($p^*=0.1$)'),TeX(r'($p^*=0.3$)'),TeX(r'($p^*=0.5$)')), 
        lty=c(1,2,3,4), pch=c(1,0,2,3),horiz=TRUE)
dev.off()

c(min(colMeans(dgp1$e91[,nums])),min(colMeans(dgp1$e101[,nums])),min(colMeans(dgp1$e111[,nums])),min(colMeans(dgp1$e121[,nums])))
c(max(colMeans(dgp1$e91[,nums])),max(colMeans(dgp1$e101[,nums])),max(colMeans(dgp1$e111[,nums])),max(colMeans(dgp1$e121[,nums])))
c(min(colMeans(dgp2$e91[,nums])),min(colMeans(dgp2$e101[,nums])),min(colMeans(dgp2$e111[,nums])),min(colMeans(dgp2$e121[,nums])))
c(max(colMeans(dgp2$e91[,nums])),max(colMeans(dgp2$e101[,nums])),max(colMeans(dgp2$e111[,nums])),max(colMeans(dgp2$e121[,nums])))
c(min(colMeans(dgp3$e91[,nums])),min(colMeans(dgp3$e101[,nums])),min(colMeans(dgp3$e111[,nums])),min(colMeans(dgp3$e121[,nums])))
c(max(colMeans(dgp3$e91[,nums])),max(colMeans(dgp3$e101[,nums])),max(colMeans(dgp3$e111[,nums])),max(colMeans(dgp3$e121[,nums])))
c(min(colMeans(dgp4$e91[,nums])),min(colMeans(dgp4$e101[,nums])),min(colMeans(dgp4$e111[,nums])),min(colMeans(dgp4$e121[,nums])))
c(max(colMeans(dgp4$e91[,nums])),max(colMeans(dgp4$e101[,nums])),max(colMeans(dgp4$e111[,nums])),max(colMeans(dgp4$e121[,nums])))
c(min(colMeans(dgp5$e91[,nums])),min(colMeans(dgp5$e101[,nums])),min(colMeans(dgp5$e111[,nums])),min(colMeans(dgp5$e121[,nums])))
c(max(colMeans(dgp5$e91[,nums])),max(colMeans(dgp5$e101[,nums])),max(colMeans(dgp5$e111[,nums])),max(colMeans(dgp5$e121[,nums])))


c(min(colMeans(dgp1$e92[,nums])),min(colMeans(dgp1$e102[,nums])),min(colMeans(dgp1$e112[,nums])),min(colMeans(dgp1$e122[,nums])))
c(max(colMeans(dgp1$e92[,nums])),max(colMeans(dgp1$e102[,nums])),max(colMeans(dgp1$e112[,nums])),max(colMeans(dgp1$e122[,nums])))
c(min(colMeans(dgp2$e92[,nums])),min(colMeans(dgp2$e102[,nums])),min(colMeans(dgp2$e112[,nums])),min(colMeans(dgp2$e122[,nums])))
c(max(colMeans(dgp2$e92[,nums])),max(colMeans(dgp2$e102[,nums])),max(colMeans(dgp2$e112[,nums])),max(colMeans(dgp2$e122[,nums])))
c(min(colMeans(dgp3$e92[,nums])),min(colMeans(dgp3$e102[,nums])),min(colMeans(dgp3$e112[,nums])),min(colMeans(dgp3$e122[,nums])))
c(max(colMeans(dgp3$e92[,nums])),max(colMeans(dgp3$e102[,nums])),max(colMeans(dgp3$e112[,nums])),max(colMeans(dgp3$e122[,nums])))
c(min(colMeans(dgp4$e92[,nums])),min(colMeans(dgp4$e102[,nums])),min(colMeans(dgp4$e112[,nums])),min(colMeans(dgp4$e122[,nums])))
c(max(colMeans(dgp4$e92[,nums])),max(colMeans(dgp4$e102[,nums])),max(colMeans(dgp4$e112[,nums])),max(colMeans(dgp4$e122[,nums])))
c(min(colMeans(dgp5$e92[,nums])),min(colMeans(dgp5$e102[,nums])),min(colMeans(dgp5$e112[,nums])),min(colMeans(dgp5$e122[,nums])))
c(max(colMeans(dgp5$e92[,nums])),max(colMeans(dgp5$e102[,nums])),max(colMeans(dgp5$e112[,nums])),max(colMeans(dgp5$e122[,nums])))

c(min(colMeans(dgp1$e93[,nums])),min(colMeans(dgp1$e103[,nums])),min(colMeans(dgp1$e113[,nums])),min(colMeans(dgp1$e123[,nums])))
c(max(colMeans(dgp1$e93[,nums])),max(colMeans(dgp1$e103[,nums])),max(colMeans(dgp1$e113[,nums])),max(colMeans(dgp1$e123[,nums])))
c(min(colMeans(dgp2$e93[,nums])),min(colMeans(dgp2$e103[,nums])),min(colMeans(dgp2$e113[,nums])),min(colMeans(dgp2$e123[,nums])))
c(max(colMeans(dgp2$e93[,nums])),max(colMeans(dgp2$e103[,nums])),max(colMeans(dgp2$e113[,nums])),max(colMeans(dgp2$e123[,nums])))
c(min(colMeans(dgp3$e93[,nums])),min(colMeans(dgp3$e103[,nums])),min(colMeans(dgp3$e113[,nums])),min(colMeans(dgp3$e123[,nums])))
c(max(colMeans(dgp3$e93[,nums])),max(colMeans(dgp3$e103[,nums])),max(colMeans(dgp3$e113[,nums])),max(colMeans(dgp3$e123[,nums])))
c(min(colMeans(dgp4$e93[,nums])),min(colMeans(dgp4$e103[,nums])),min(colMeans(dgp4$e113[,nums])),min(colMeans(dgp4$e123[,nums])))
c(max(colMeans(dgp4$e93[,nums])),max(colMeans(dgp4$e103[,nums])),max(colMeans(dgp4$e113[,nums])),max(colMeans(dgp4$e123[,nums])))
c(min(colMeans(dgp5$e93[,nums])),min(colMeans(dgp5$e103[,nums])),min(colMeans(dgp5$e113[,nums])),min(colMeans(dgp5$e123[,nums])))
c(max(colMeans(dgp5$e93[,nums])),max(colMeans(dgp5$e103[,nums])),max(colMeans(dgp5$e113[,nums])),max(colMeans(dgp5$e123[,nums])))

